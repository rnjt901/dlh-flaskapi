name : build and push docker image

on:
    push:
        branches:
              -main

jobs:
  build-and-push:
    runs-on: ubuntu-latest
    steps:
      -name: checkout code
       uses: actions/checkout@v3

      -name: log in to dockerhub
       uses: docker/login-action@v2
       with:
        username: ${{secrets.docker_username}}
        password: ${{secrets.docker_password}}

      -name: build and push image
       run: |
        docker build -t flask-api:latest .
        docker tag flask-api:${{ github.sha}} rnjt901/flask-api:${{ github.sha}}:latest
        docker push rnjt901/flask-api:${{ github.sha }}
